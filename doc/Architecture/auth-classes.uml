@startuml

' definitions
' -----------

' package "edu.harvard.iq.dataverse.authorization"
class AccessRequest
class AllUsers
class ApiKey
class AuthenticatedUser
class AuthenticatedUsers
interface AuthenticationManager
interface AuthenticationProvider
class ExplicitGroup
interface Group
interface GroupCreator
class GuestUser
class IpGroup
class LocalAuthenticationProvider
interface RoleAssignee
class ShibAuthenticationProvider
class ShibGroup
interface User
interface UserLister
' end package

' content
' -------

' LocalAuthenticationProvider:
AuthenticationProvider <|.. LocalAuthenticationProvider
UserLister <|.. LocalAuthenticationProvider
GroupCreator <|.. LocalAuthenticationProvider
LocalAuthenticationProvider : RoleAssignee getRoleAssignee(String)
LocalAuthenticationProvider : List listUsers()
LocalAuthenticationProvider : Group createGroup()

' AllUsers:
Group <|.. AllUsers

' AuthenticationProvider:
AuthenticationProvider : RoleAssignee getRoleAssignee(String)

' ShibAuthenticationProvider:
AuthenticationProvider <|.. ShibAuthenticationProvider
GroupCreator <|.. ShibAuthenticationProvider
ShibAuthenticationProvider : RoleAssignee getRoleAssignee(String)
ShibAuthenticationProvider : Group createGroup()

' AuthenticationManager:
AuthenticationManager : Collection authenticationProviders
AuthenticationManager : void registerProvider(AuthenticationProvider)

' IpGroup:
Group <|.. IpGroup

' Group:
Group : String name
Group : String description
Group : Collection roleAssignees

' ApiKey:
ApiKey : String getKey()
ApiKey : String getTitle()

' GroupCreator:
GroupCreator : Group createGroup()

' AuthenticatedUsers:
Group <|.. AuthenticatedUsers

' ShibGroup:
Group <|.. ShibGroup
ShibGroup : Map getHeaderMatches()

' RoleAssignee:
RoleAssignee : String identifier
RoleAssignee : boolean showInLists
RoleAssignee : String displayInfo()

' AuthenticatedUser:
User <|.. AuthenticatedUser

' AccessRequest:
AccessRequest --> "1" AuthenticatedUser

' User:

' UserLister:
UserLister : List listUsers()

' ExplicitGroup:
Group <|.. ExplicitGroup
ExplicitGroup : void add(RoleAssignee)
ExplicitGroup : void remove(RoleAssignee)
ExplicitGroup : List getRoleAssignees()

' GuestUser:
User <|.. GuestUser

@enduml
