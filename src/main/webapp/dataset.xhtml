<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"  
      xmlns:h="http://java.sun.com/jsf/html"  
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"      
      xmlns:p="http://primefaces.org/ui">  

    <h:head>  
        <style type="text/css">
            .column75{width: 75%;height:auto}
            .column25{width: 25%;height:auto}
            .column60{width: 60%;height:auto}
            .column40{width: 40%;height:auto}            
        </style>
    </h:head>

    <h:body> 
        <f:metadata>
            <f:viewParam name="id" value="#{DatasetPage.dataset.id}"/>
            <f:viewParam name="ownerId" value="#{DatasetPage.ownerId}"/>
            <f:viewAction action="#{DatasetPage.init}" />
        </f:metadata>        

        <h:form id="datasetForm">
            <p:panel  style="background-color: lightskyblue; height:70px;">
                <ui:repeat value="#{DatasetPage.dataset.owner.owners}" var="owner">                   
                    <h:outputLink value="/dataverse.xhtml?id=#{owner.id}">
                        <h:outputText value="#{owner.name}" />             
                    </h:outputLink> 
                    <h:outputText value=" > "/>
                </ui:repeat>
                <br/>
                <h:outputLink value="/dataverse.xhtml?id=#{DatasetPage.dataset.owner.id}">
                    <h:outputText value="#{DatasetPage.dataset.owner.name} Dataverse" /> 
                </h:outputLink>
            </p:panel>
            
            <p:panel  rendered="#{DatasetPage.editMode}">
                <h:outputText value="Edit your dataset's information:" rendered="#{DatasetPage.dataset.id != null}"/>
                <h:outputText value="Upload your dataverse:" rendered="#{DatasetPage.dataset.id == null}"/>
            </p:panel>              

            <p:panel>
                <h:outputText value="#{DatasetPage.dataset.title}" rendered="#{!DatasetPage.editMode}"/>
                <p:panelGrid columns="2"  columnClasses="column60,column40"  rendered="#{DatasetPage.editMode}">
                    <p:panelGrid columns="3" rendered="#{DatasetPage.editMode}">
                        <p:outputLabel value="Title" for="title" />
                        <ui:fragment>
                            <p:inputText id="title" value="#{DatasetPage.dataset.title}" />
                            <p:watermark for="title" value="Enter title..."/>
                        </ui:fragment>
                        <p:message for="title" />
                    </p:panelGrid>
                    <p:panelGrid columns="2">
                        <h:outputText value="Host Dataverse"/>
                        <p:selectOneMenu value="#{DatasetPage.ownerId}" filter="true" filterMatchMode="startsWith" effect="none">    
                            <f:selectItems value="#{dataverseServiceBean.findAll()}" var="dv" itemLabel="#{dv.name}" itemValue="#{dv.id}"/>   
                        </p:selectOneMenu>  
                    </p:panelGrid>             
                </p:panelGrid>
            </p:panel>

            <p:panel rendered="#{!DatasetPage.editMode}">
                <p:panelGrid columns="2"  columnClasses="column75,column25">
                    <p:panel>
                        <p:panel style="background-color: lightgrey;">
                            <h:outputText style="background-color: lightgrey;" value="#{DatasetPage.dataset.citation}" />
                        </p:panel>
                        <p:panel>
                            <p:panelGrid columns="3">
                                <p:commandButton value="Copy Citation" disabled="true"/>
                                <h:outputLink  onclick="PF('whyCite').show();">
                                    <h:outputText value="Why cite?" style="color: green" />
                                </h:outputLink>
                                <h:outputText value="image" style="color: red" />                             
                            </p:panelGrid>
                                <p:dialog header="Why cite?" widgetVar="whyCite" modal="true" height="100">  
                                    <h:outputText value="Info on why to use a data citation." />  
                                </p:dialog>                                
                        </p:panel>
                    </p:panel>
                    <p:panel>
                        <p:menuButton value="Edit Data Set" iconPos="right"> 
                            <p:menuitem value="Edit Info" actionListener="#{DatasetPage.edit}" update="@all"/>
                            <p:menuitem value="Edit Permissions" disabled="true"/>  
                        </p:menuButton>  
                    </p:panel>
                </p:panelGrid>
            </p:panel>

            <p:panel rendered="#{DatasetPage.editMode}">
                <p:panelGrid columns="2"  columnClasses="column75,column25">
                    <p:panelGrid columns="2">
                        <h:outputText value="Data Citation"/>
                        <p:panelGrid columns="3">
                            <p:outputLabel value="Author" for="author" />
                            <p:inputText id="author" value="#{DatasetPage.dataset.author}" />
                            <p:message for="author" />

                            <p:outputLabel value="Date" for="date" />
                            <p:inputText id="date" value="#{DatasetPage.dataset.citationDate}" />
                            <p:message for="date" />

                            <p:outputLabel value="Distributor" for="distributor" />
                            <p:inputText id="distributor" value="#{DatasetPage.dataset.distributor}" />
                            <p:message for="distributor" />
                        </p:panelGrid> 
                    </p:panelGrid>                         
                    <p:panel>
                        <p:commandButton value="Save" actionListener="#{DatasetPage.save}" update="@all" />
                        <p:commandButton value="Cancel" actionListener="#{DatasetPage.cancel}" process="@this" update="@all"  rendered="#{DatasetPage.dataset.id != null}" />
                        <p:button value="Cancel" outcome="/dataverse.xhtml?id=#{DatasetPage.ownerId}"  rendered="#{DatasetPage.dataset.id == null}" />
                    </p:panel>
                </p:panelGrid>
            </p:panel>                

            <p:panel>
                <h:outputText value="#{DatasetPage.dataset.description}" rendered="#{!DatasetPage.editMode}" />
                <p:panelGrid columns="3" rendered="#{DatasetPage.editMode}">
                    <p:outputLabel value="Description" for="description"/>
                    <p:inputTextarea  id="description" value="#{DatasetPage.dataset.description}"
                                      rows="5" cols="30" counter="counter" maxlength="1000"       
                                      counterTemplate="{0} characters remaining." autoResize="false"/>
                    <h:outputText id="counter" /> 
                </p:panelGrid>
            </p:panel>

            <p:panel rendered="#{!DatasetPage.editMode}">
                <h:outputText value="[One day files. metadata, and versions will show here.]"/>
            </p:panel>  

            <p:panel rendered="#{DatasetPage.editMode}">
                <h:outputText value="[One day upload files will show here.]"/>
            </p:panel>  
            

        </h:form>
    </h:body> 
</html> 