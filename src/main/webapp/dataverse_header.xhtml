<div xmlns="http://www.w3.org/1999/xhtml"
     xmlns:h="http://java.sun.com/jsf/html"
     xmlns:f="http://java.sun.com/jsf/core"
     xmlns:ui="http://java.sun.com/jsf/facelets"
     xmlns:p="http://primefaces.org/ui">

    <!-- Header Panel -->
    <p:panel style="background-color: lightskyblue; height:70px;">
        <p:panelGrid styleClass="panelgridHeaderTable" columns="2">
            <ui:fragment>
                <h:outputLink value="/dataverse.xhtml?id=#{dataverse.id}" rendered="#{dataverse.id != null}">
                    <h:outputText id="nameOutput" value="#{dataverse.name} Dataverse" style="font-size:1.5em;font-weight:bold; padding:4px 0 4px 34px; background: url(/resources/images/icon_dataverse.png) no-repeat 0 50%;"/>
                </h:outputLink>

                <h:outputText value="New Dataverse" style="font-size:1.5em;font-weight:bold;" rendered="#{dataverse.id == null and ownerId != null}"/>

                <h:outputText value="Welcome to the Dataverse Network" style="font-size:1.5em;font-weight:bold;" rendered="#{dataverse.id == null and ownerId == null}"/>
            </ui:fragment>
            <ui:fragment>
                <p:panelGrid columns="2">
                    <ui:fragment>
                        <h:outputLink value="/dataverseuser.xhtml?editMode=CREATE" rendered="#{dataverseSession.user.guest}">
                            Create Account
                        </h:outputLink>
                        <h:outputLink value="/dataverseuser.xhtml?editMode=INFO" rendered="#{!dataverseSession.user.guest}">
                            <h:outputText value="#{dataverseSession.user.firstName} #{dataverseSession.user.lastName}" />
							<span style="margin-left: 5px; font-size:10pt">
								<h:outputLink value="loginpage.xhtml">
									(not you?)
								</h:outputLink>
							</span>
                        </h:outputLink>
                    </ui:fragment>
                    <ui:fragment>
                        <h:outputLink value="/loginpage.xhtml" rendered="#{dataverseSession.user.guest}">
                            Log In
                        </h:outputLink>
                        <h:form id="headerForm">
                            <h:commandLink actionListener="#{dataverseSession.setUser(null)}" rendered="#{!dataverseSession.user.guest}">
                                Log Out
                            </h:commandLink>
                        </h:form>
                    </ui:fragment>
                </p:panelGrid>
            </ui:fragment>
        </p:panelGrid>
    </p:panel>

    <style type="text/css">
        div[id$='breadcrumbNavBlock'] > .ui-panel-content {overflow:hidden;}
        
        button[id$='breadcrumbBtn'] span.ui-button-text, 
        button[id$='breadcrumbBtn2'] span.ui-button-text {padding-top:0; padding-bottom:0;}
        
        button[id$='breadcrumbBtn'] span.ui-button-text {padding-top:1px;}
        button[id$='breadcrumbBtn2'] span.ui-button-text {font-weight:bold;}
        
        button[id$='breadcrumbBtn'] .ui-button-icon-left, 
        button[id$='breadcrumbBtn2'] .ui-button-icon-left {left:1em;}
        
        div[id$='breadcrumbNavBlock'] .breadcrumbCarrot {float:left; margin:0 .2em; color:#B3B3B3;}
        
        div[id$='breadcrumbNavBlock'] > .ui-widget-content > .ui-tree.ui-widget-content > .ui-tree-container,
        div[id$='breadcrumbNavBlock'] > .ui-widget-content > .ui-tree.ui-widget-content > .ui-tree-container > .ui-treenode {padding:0;}
        
        div[id$='breadcrumbNavBlock'] > .ui-widget-content > .ui-tree.ui-widget-content > .ui-tree-container > .ui-treenode .ui-treenode-label {padding:0; margin:0;}
        
        div[id$='breadcrumbNavBlock'] button[id$='breadcrumbBtn'], 
        div[id$='breadcrumbNavBlock'] button[id$='breadcrumbBtn2'] {float:left; border:0; box-shadow:none; background: none;}
        div[id$='breadcrumbNavBlock'] button[id$='breadcrumbBtn'] span.ui-icon, 
        div[id$='breadcrumbNavBlock'] button[id$='breadcrumbBtn2'] span.ui-icon {background-position: -64px -16px;}
        
        div[id$='breadcrumbNavBlock'] .ui-tree.ui-widget-content {border:0;}
        
        
        
    </style>

    <!-- Breadcrumbs Panel -->
    <p:panel id="breadcrumbNavBlock" styleClass="panelLayoutBlock" rendered="#{showBreadcrumbs}">

        <ui:repeat value="#{dataverse.owners}" var="owner">
            <p:commandButton id="breadcrumbBtn" value="#{owner.name} Dataverse" type="button" icon="/javax.faces.resource/images/ui-icons_333333_256x240.png.xhtml?ln=primefaces-bootstrap"/>
            
            <p:overlayPanel id="breadcrumbPanel" for="breadcrumbBtn" hideEffect="fade">  
                <p:tree value="#{dataverseHeaderFragment.getDataverseTree(owner)}" var="node" dynamic="true" cache="true" id="tree">
                  <p:treeNode>
                      <h:outputLink value="/dataverse.xhtml?id=#{node.id}">
                          <h:outputText value="#{node.name} Dataverse" style="font-weight: #{dataverse.id == node.id ? 'bold' : 'normal'}"/>
                      </h:outputLink>
                  </p:treeNode>
                </p:tree>
            </p:overlayPanel>
                
            <h:outputText value=" > " styleClass="breadcrumbCarrot"/>
        </ui:repeat>
        
        <p:commandButton id="breadcrumbBtn2" value="#{dataverse.name} Dataverse" type="button" icon="/javax.faces.resource/images/ui-icons_333333_256x240.png.xhtml?ln=primefaces-bootstrap"/>
            
        <p:overlayPanel id="breadcrumbPanel2" for="breadcrumbBtn2" hideEffect="fade">  
            <p:tree value="#{dataverseHeaderFragment.getDataverseTree(dataverse)}" var="node" dynamic="true" cache="true" id="tree2">
                <p:treeNode>
                  <h:outputText value="#{node.name} Dataverse" style="font-weight:bold;" rendered="#{dataset == null and dataverse.id == node.id}"/>

                  <h:outputLink value="/dataverse.xhtml?id=#{node.id}" rendered="#{dataset != null or dataverse.id != node.id}">
                        <h:outputText value="#{node.name} Dataverse"/>
                  </h:outputLink>
                </p:treeNode>
            </p:tree>
        </p:overlayPanel>

            

        <ui:fragment rendered="#{!empty dataset.latestVersion.metadata.title}">
            <h:outputText value=" > " styleClass="breadcrumbCarrot"/>
            <h:outputText value="#{dataset.latestVersion.metadata.title}" style="float:left; font-weight:bold;"/>
        </ui:fragment>
    </p:panel>


    <!-- Message Panel -->
    <p:panel styleClass="panelLayoutTitleBlock" rendered="#{showMessagePanel}">
        <p:messages id="messages" showDetail="true" autoUpdate="true" closable="true"/>
    </p:panel>

</div>
