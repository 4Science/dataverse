<ui:composition xmlns="http://www.w3.org/1999/xhtml"
     xmlns:h="http://java.sun.com/jsf/html"
     xmlns:f="http://java.sun.com/jsf/core"
     xmlns:ui="http://java.sun.com/jsf/facelets"
     xmlns:c="http://java.sun.com/jsp/jstl/core"
     xmlns:p="http://primefaces.org/ui"
     xmlns:o="http://omnifaces.org/ui"
     xmlns:jsf="http://xmlns.jcp.org/jsf">
         
      <script src="#{resource['js/handlebars-v3.0.3.js']}?version=#{systemConfig.getVersion()}"></script>
                
                <script id="pagination-template" type="text/x-handlebars-template">
                    <br />Results found: <b>{{ numResults }}</b>, Displaying <b>{{ startCardNumber }}</b> to <b>{{ endCardNumber }}</b>
                    <br />
                    <ul class="pagination">
                        {{#if previousPageNumber}}
                            <li><a aria-label="First" class="page_link" rel="1"><span aria-hidden="true">&lt;&lt;</span></a></li>
                            <li><a aria-label="Previous" class="page_link" rel="{{ previousPageNumber }}"><span aria-hidden="true">&lt; Previous</span></a></li>
                        {{/if}}
                        {{#pageNumberList}}

                        {{#isSelectedPage this ../selectedPageNumber }}
                            <li class="active"><a rel="{{this}}" class="page_link">{{this}}</a></li>
                        {{/isSelectedPage}}
                        {{^isSelectedPage this ../selectedPageNumber }}
                            <li><a rel="{{this}}" class="page_link">{{this}}</a></li>
                        {{/isSelectedPage}}
                        {{/pageNumberList}}
                        {{#if nextPageNumber}}
                            <li><a href="#" aria-label="Next" class="page_link" rel="{{ nextPageNumber }}"><span aria-hidden="true">Next &gt;</span></a></li>
                            <li><a href="#" aria-label="Last" class="page_link" rel="{{ pageCount }}"><span aria-hidden="true">&gt;&gt;</span></a></li>
                        {{/if}}
                    </ul>
                </script>
                <script>
                
                Handlebars.registerHelper('isSelectedPage', function(lvalue, rvalue, options) {
                    console.log("lvalue:" + lvalue + ":" + rvalue);
                    if( lvalue!=rvalue ) {
                        return options.inverse(this);
                    } else {
                        return options.fn(this);
                    }
                });
                //Handlebars.registerHelper('ifSelectedPage', function(pgNum, selectedPage, options) {
                     
                //      return 'blah';
                //});
                /*
                 * Example of pager_info:
                 * no results: {"isNecessary":false}
                 * results: {"isNecessary":true,"docsPerPage":10,"pageCount":12,"startCardNumber":21,"previousPageNumber":2,"selectedPageNumber":3,"numResults":111,"endCardNumber":30,"nextPageNumber":4,"pageNumberList":[1,2,3,4,5,6,7,8,9,10,11,12]} 
                 */
                function makePager(pager_info){
                    
                    if (!pager_info.isNecessary){
                        $("#pagination").html('(no pager)');
                        return;
                    }else{
                        var source   = $("#pagination-template").html();
                        var template = Handlebars.compile(source);
                        //var context = {title: "My New Post", body: "This is my first post!"};
                        var pagination_html    = template(pager_info);
                        $("#pagination").html(pagination_html);
                        // alert(pager_info.pageCount);
                    }
                    
                }
                        
                $(document).ready(function() {
                        //var json_info = <h:outputText value="#{RolePermissionHelperPage.pager.asJSONString()}" escape="false" />;
                        var json_info = <h:outputText value="#{RolePermissionHelperPage.getRandomPagerJSON()}" escape="false" />;
                        makePager(json_info);
                });
                </script>
              
</ui:composition>