<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:f="http://java.sun.com/jsf/core"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:jsf="http://xmlns.jcp.org/jsf"
      xmlns:p="http://primefaces.org/ui">

  <h:head>

  </h:head>

  <h:body>
    <ui:composition template="/dataverse_template.xhtml">
      <ui:param name="pageTitle" value="Role/Permission Relationships - #{dataverseServiceBean.findRootDataverse().name} #{bundle.dataverse}"/>
      <ui:param name="showDataverseHeader" value="false"/>
      <ui:define name="body">
          <f:metadata>
                <ui:remove>
                    <f:viewParam name="id" value="#{DatasetPage.dataset.id}"/>
                    <f:viewParam name="ownerId" value="#{DatasetPage.ownerId}"/>
                    <f:viewParam name="version" value="#{DatasetPage.version}"/>
                    <f:viewParam name="versionId" value="#{DatasetPage.versionId}"/>
                    <f:viewParam name="persistentId" value="#{DatasetPage.persistentId}"/>
                </ui:remove>
                    <f:viewAction action="#{RolePermissionHelperPage.init}" />
          </f:metadata>
          <div>
              <div id="pagination"></div>
              <div id="divPagerJSON">anything here?</div>

              <div class="row">
                  <div class="col-md-2">
                      <ul id="id_dvobject_types">
                          <li><label for="id_dvobject_types_0"><input checked="checked" id="id_dvobject_types_0" name="dvobject_types" type="checkbox" value="dataverses" /> Dataverses</label></li>
                          <li><label for="id_dvobject_types_1"><input checked="checked" id="id_dvobject_types_1" name="dvobject_types" type="checkbox" value="datasets" /> Datasets</label></li>
                          <li><label for="id_dvobject_types_2"><input checked="checked" id="id_dvobject_types_2" name="dvobject_types" type="checkbox" value="files" /> Files</label></li>
                      </ul>
                  </div>
                  <script>
                        function checkDtypes(){
                            var dype_values = new Array();
                            $.each($("input[name='dvobject_types']:checked"), function() {
                                dype_values.push($(this).val());
                              // or you can do something to the actual checked checkboxes by working directly with  'this'
                              // something like $(this).hide() (only something useful, probably) :P
                            });
                            alert(dype_values);
                        }
                        $(document).ready(function() {
          
                            $("input[name='dvobject_types']").click(function() {
                                checkDtypes();
                              // or you can do something to the actual checked checkboxes by working directly with  'this'
                              // something like $(this).hide() (only something useful, probably) :P
                            });
                     
                            
                         });
                  </script>
                  <div class="col-md-2"></div>
              </div>
              <p> 
                    <!--pre><h:outputText value="#{RolePermissionHelperPage.getMyDataFinderInfo()}" escape="false" /> </pre-->
                    <b>Results from FilterParams</b>
                    <pre><h:outputText value="#{RolePermissionHelperPage.getFilterParams()}" escape="false" /> </pre>
                    <br />
                    <b>Results from MyDataFinder</b>
                    <pre><h:outputText value="#{RolePermissionHelperPage.myDataFinder.getTestString()}" escape="false" /></pre>
                    <div style="padding: 10px 30px;">
                        <b>solr query</b>

                        <pre>
                            <h:outputText rendered="#{!RolePermissionHelperPage.myDataFinder.hasError()}" value="#{RolePermissionHelperPage.myDataFinder.solrDvObjectFilterQuery}" escape="false" />
                            <h:outputText rendered="#{RolePermissionHelperPage.myDataFinder.hasError()}" value="Error found in earlier step" escape="false" />
                        </pre>
                    </div>

                    <b>getSomeJSON:</b>
                    
                    <pre><h:outputText value="#{RolePermissionHelperPage.someJSON}" escape="false" /> </pre>
                    <pre><h:outputText value="#{RolePermissionHelperPage.pager.asJSONString()}" escape="false" /> </pre>
              </p>
              <h4>Related roles for each DvObject type</h4>
    <table class="table table-bordered table-condensed text-center">


<!-- start: Iterate through a list of lists -->        
<ui:repeat value="#{RolePermissionHelperPage.rolePermissionHelper.rolesByDvObjectTable}" var="singleRow">
    <tr>
    <ui:repeat value="#{singleRow}" var="dvValue">
        <td>        
         <ui:fragment rendered="#{dvValue == 'YES'}">
             <span class="label label-success">Yes</span>
         </ui:fragment>
         <ui:fragment rendered="#{dvValue != 'YES'}">
              <h:outputText value="#{dvValue}" escape="false" />
         </ui:fragment>
        </td>
    </ui:repeat>
    </tr>
</ui:repeat>
<!-- end: Iterate through a list of lists -->   
    </table>
         <!--ui:include src="mydata_js_pagination.xhtml"></ui:include-->
         <ui:include src="mydata_pager_render.xhtml"></ui:include>

                        
             <h4>roles with dataverse permissions</h4>
            <p>
                <h:outputText value="#{RolePermissionHelperPage.rolePermissionHelper.getRolesWithDataversePermissionsAsHTML()}" escape="false" /> 
             </p>
                  

                 <h4>roles with dataset permissions</h4>
             <p>                 
                <h:outputText value="#{RolePermissionHelperPage.rolePermissionHelper.getDatasetRolesAsHTML()}" escape="false" /> 
             </p>
              
                 <h4>roles with file permissions</h4>
            <p>
                 
                <h:outputText value="#{RolePermissionHelperPage.rolePermissionHelper.getRolesWithFilePermissionsAsHTML()}" escape="false" /> 

             </p><ui:remove> 
            <ui:repeat value="#{RolePermissionHelperPage.rolePermissionHelper.rolesWithDataversePermissions}" var="info">
   <li> 
  <h:inputText value="#{info.getKey()}" />
  <h:inputText value="#{info.getValue()}" />
   </li> 
  </ui:repeat>     
             <hr />
             <hr />
            <h:outputText value="#{RolePermissionHelperPage.getRoleInfo()}" escape="false" /> 

                        <hr />
            <h:outputText value="#{RolePermissionHelperPage.rolePermissionHelper.roleNameListString}" escape="false" /> 
            <hr />

             <h:outputText value="#{RolePermissionHelperPage.rolePermissionHelper.rolesWithDataversePermissions}" escape="false" /> 
</ui:remove>
             
          </div>
      </ui:define>
    </ui:composition>
  </h:body>
</html>
