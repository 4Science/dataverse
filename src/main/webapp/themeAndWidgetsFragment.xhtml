<div 
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:c="http://java.sun.com/jsp/jstl/core"
    xmlns:jsf="http://xmlns.jcp.org/jsf"
    xmlns:p="http://primefaces.org/ui">
    <!-- Theme and Widgets Popup -->
    <p:dialog id="themeAndWidgetsDlg" header="Theme + Widgets" widgetVar="themeAndWidgetsForm" modal="true" styleClass="largePopUp">
        <p:tabView binding="#{themeWidgetFragment.tabView}"  rendered="#{themeWidgetFragment.editDv!=null}" id="themeWidgetsTabView" widgetVar="content">
            <p:tab  id="themeTab" title="Theme">
                <!-- Dataverse Theme Panel -->
                <div class="row form-horizontal">
                    
                    <div class="form-group">
                        <label class="col-sm-3 control-label" for="inheritCustomization" style="white-space:nowrap;">
                            <a href="#" data-toggle="tooltip" data-placement="auto right" class="tooltiplabel right" data-original-title="Tooltip description.">
                                Inherit Customization
                            </a>
                        </label>
                        <div class="col-sm-9">
                            <div class="checkbox">
                                <label>
                                    <input type="checkbox" id="inheritCustomization"
                                           name="inheritCustomization" />
                                    Inherit the customization from the parent dataverse to this dataverse.
                                </label>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label class="col-sm-3 control-label" for="logoFormat" style="white-space:nowrap;">
                            <a href="#" data-toggle="tooltip" data-placement="auto right" class="tooltiplabel right" data-original-title="Tooltip description.">
                                Logo Image
                            </a>
                        </label>
                        <div class="form-group col-sm-9">
                            <p:panelGrid rendered="#{not empty themeWidgetFragment.editDv.logo}" columns="3" styleClass="noBorders" columnClasses="text-center,uploadNewLogo,messageCell">
                                <p:column>
                                    <p>
                                        <img jsf:rendered="#{themeWidgetFragment.uploadExists()}" class="logoPreview" src="/logos/temp/#{themeWidgetFragment.tempDirName}/#{themeWidgetFragment.editDv.logo}" alt="#{dv.name} Dataverse"/>
                                        <img jsf:rendered="#{not themeWidgetFragment.uploadExists()}" class="logoPreview" src="/logos/#{themeWidgetFragment.editDv.id}/#{themeWidgetFragment.editDv.logo}" alt="#{dv.name} Dataverse"/>
                                    </p>
                                    <p:commandButton update=":dataverseForm:themeWidgetsTabView" value="Remove" action="#{themeWidgetFragment.removeLogo()}"/>
                                </p:column>
                                <p:fileUpload id="changelogo" allowTypes="/(\.|\/)(jpg|jpeg|tff|png|gif)$/" update=":dataverseForm:themeWidgetsTabView" dragDropSupport="true" auto="true" multiple="false"
                                              fileUploadListener="#{themeWidgetFragment.handleImageFileUpload}" label="Upload New File"/>
                                <p:message for="changelogo"/>
                            </p:panelGrid>

                            <p:panelGrid rendered="#{empty themeWidgetFragment.editDv.logo}" columns="2" styleClass="noBorders">
                                <p:fileUpload id="uploadlogo" update=":dataverseForm:themeWidgetsTabView" dragDropSupport="true" auto="true" multiple="false"
                                              fileUploadListener="#{themeWidgetFragment.handleImageFileUpload}" label="Upload Image File"/>
                                <p:message for="uploadlogo"/>
                            </p:panelGrid>
                            
                            <ui:fragment rendered="#{not empty themeWidgetFragment.editDv.logo}">
                                <div class="form-col-container col-sm-4">
                                    <label for="logoFormat" class="control-label">
                                        <a href="#" data-toggle="tooltip" data-placement="auto right" class="tooltiplabel right" data-original-title="Tooltip description.">
                                            Logo Format
                                        </a>
                                    </label>
                                    <div>
                                        <p:panelGrid columns="2" styleClass="noBorders">
                                            <p:selectOneRadio id="logoFormat" value="#{themeWidgetFragment.editDv.logoFormat}">
                                                <f:selectItem itemLabel="Square" itemValue="SQUARE"/>
                                                <f:selectItem itemLabel="Rectangle" itemValue="RECTANGLE"/>
                                            </p:selectOneRadio>
                                            <p:message for="logoFormat"/>
                                        </p:panelGrid>
                                    </div>
                                </div>
                                <div class="form-col-container col-sm-3">
                                    <label for="logoAlignment" class="control-label">
                                        <a href="#" data-toggle="tooltip" data-placement="auto right" class="tooltiplabel right" data-original-title="Tooltip description.">
                                            Logo Alignment
                                        </a>
                                    </label>
                                    <div>
                                        <p:panelGrid columns="2" styleClass="noBorders">
                                            <p:selectOneMenu id="logoAlignment" styleClass="form-control" value="#{themeWidgetFragment.editDv.logoAlignment}">
                                                <f:selectItem id="left" itemLabel="Left" itemValue="LEFT" />
                                                <f:selectItem id="center" itemLabel="Center" itemValue="CENTER" />
                                                <f:selectItem id="right" itemLabel="Right" itemValue="RIGHT" />
                                            </p:selectOneMenu>
                                            <p:message for="logoAlignment"/>
                                        </p:panelGrid>
                                    </div>
                                </div>
                                <div class="form-col-container col-sm-4">
                                    <label for="logoBackgroundColor" class="control-label">
                                        <a href="#" data-toggle="tooltip" data-placement="auto right" class="tooltiplabel right" data-original-title="Tooltip description.">
                                            Logo Background Color
                                        </a>
                                    </label>
                                    <div>
                                        <p:panelGrid columns="2" styleClass="noBorders">
                                            <p:colorPicker id="logoBackgroundColor" value="#{themeWidgetFragment.editDv.logoBackgroundColor}"/>
                                            <p:message for="logoBackgroundColor"/>
                                        </p:panelGrid>
                                    </div>
                                </div>
                            </ui:fragment>
                            
                        </div>
                    </div>
                </div>
                
                <div class="row form-horizontal">
                    <div class="form-group">
                        <label class="col-sm-3 control-label" style="white-space:nowrap;">
                            <a href="#" data-toggle="tooltip" data-placement="auto right" class="tooltiplabel right" data-original-title="Tooltip description.">
                                Header Colors
                            </a>
                        </label>
                        <div class="form-group col-sm-9">
                                <div class="form-col-container col-sm-4">
                                    <label for="backgroundColor" class="control-label">
                                        <a href="#" data-toggle="tooltip" data-placement="auto right" class="tooltiplabel right" data-original-title="Tooltip description.">
                                            Background Color
                                        </a>
                                    </label>
                                    <div>
                                        <p:panelGrid columns="2" styleClass="noBorders">
                                            <p:colorPicker id="backgroundColor" value="#{themeWidgetFragment.editDv.backgroundColor}"/>
                                            <p:message for="backgroundColor"/>
                                        </p:panelGrid>
                                    </div>
                                </div>
                                <div class="form-col-container col-sm-4">
                                    <label for="linkColor" class="control-label">
                                        <a href="#" data-toggle="tooltip" data-placement="auto right" class="tooltiplabel right" data-original-title="Tooltip description.">
                                            Link Color
                                        </a>
                                    </label>
                                    <div>
                                        <p:panelGrid columns="2" styleClass="noBorders">
                                            <p:colorPicker id="linkColor" value="#{themeWidgetFragment.editDv.linkColor}"/>
                                            <p:message for="linkColor"/>
                                        </p:panelGrid>
                                    </div>
                                </div>
                                <div class="form-col-container col-sm-4">
                                    <label for="textColor" class="control-label">
                                        <a href="#" data-toggle="tooltip" data-placement="auto right" class="tooltiplabel right" data-original-title="Tooltip description.">
                                            Text Color
                                        </a>
                                    </label>
                                    <div>
                                        <p:panelGrid columns="2" styleClass="noBorders">
                                            <p:colorPicker id="textColor" value="#{themeWidgetFragment.editDv.textColor}"/>
                                            <p:message for="textColor"/>
                                        </p:panelGrid>
                                    </div>
                                </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label" for="tagline" style="white-space:nowrap;">
                            <a href="#" data-toggle="tooltip" data-placement="auto right" class="tooltiplabel right" data-original-title="Tooltip description.">
                                Tagline
                            </a>
                        </label>
                        <div class="col-sm-8">
                            <p:panelGrid columns="2" styleClass="noBorders" columnClasses="col-sm-6,col-sm-3" style="width:100%;">
                                <p:inputText styleClass="form-control" id="tagline" value="#{themeWidgetFragment.editDv.tagline}"/>
                                <p:message for="tagline"/>
                            </p:panelGrid>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label" for="linkUrl" style="white-space:nowrap;">
                            <a href="#" data-toggle="tooltip" data-placement="auto right" class="tooltiplabel right" data-original-title="Tooltip description.">
                                Link URL
                            </a>
                        </label>
                        <div class="col-sm-8">
                            <p:panelGrid columns="2" styleClass="noBorders" columnClasses="col-sm-6,col-sm-3" style="width:100%;">
                                <p:inputText validatorMessage="Invalid URL." validator="#{themeWidgetFragment.validateUrl}" styleClass="form-control" id="linkUrl" value="#{themeWidgetFragment.editDv.linkUrl}"/>
                                <p:message for="linkUrl"/>
                            </p:panelGrid>
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-3 control-label" for="linkText" style="white-space:nowrap;">
                            <a href="#" data-toggle="tooltip" data-placement="auto right" class="tooltiplabel right" data-original-title="Tooltip description.">
                                Link Text
                            </a>
                        </label>
                        <div class="col-sm-8">
                            <p:panelGrid columns="2" styleClass="noBorders" columnClasses="col-sm-6,col-sm-3" style="width:100%;">
                                <p:inputText styleClass="form-control" id="linkText" value="#{themeWidgetFragment.editDv.linkText}"/>
                                <p:message for="linkText"/>
                            </p:panelGrid>
                        </div>
                    </div>
                </div>
                <p:commandButton update=":dataverseForm:themeWidgetsTabView" oncomplete="saveThemeHandleComplete(xhr, status, args);" value="Save Changes" action="#{themeWidgetFragment.save()}"/>
                <p:commandButton id="widgetsDone" type="button" onclick="themeAndWidgetsForm.hide()" value="Cancel"></p:commandButton>
            </p:tab>
            <p:tab id="widgetsTab" title="Widgets">
                <div>
                    <p class="bg-info" style="padding: 15px;">Copy and paste this code into the HTML on your site.</p>
                </div>
                <div>
                    <h5>
                        Dataverse Search Box
                    </h5>
                    <span class="text-muted">Add a way for visitors on your website to be able to search Dataverse.</span>
                </div>
                <div>
                    <textarea rows="3" cols="54" class="form-control">&lt;script src=&quot;#{DataversePage.dataverseSiteUrl}/resources/js/widgets.js?id=#{themeWidgetFragment.editDv.id}&amp;amp;dvUrl=#{DataversePage.dataverseSiteUrl}&amp;amp;widget=search&quot;&gt;&lt;/script&gt;
                    </textarea>
                </div>
                <div>
                    <h5>
                        Dataverse Listing
                    </h5>
                    <span class="text-muted">Add a way for visitors on your website to be able to view your dataverses and datasets, sort and page through them.</span>
                </div>
                <div>
                    <textarea rows="2" cols="54" class="form-control">&lt;script src=&quot;#{DataversePage.dataverseSiteUrl}/resources/js/widgets.js?id=#{themeWidgetFragment.editDv.id}&amp;amp;dvUrl=#{DataversePage.dataverseSiteUrl}&amp;amp;widget=iframe&quot;&gt;&lt;/script&gt;
                    </textarea>
                </div>
                <button id="widgetsDone" type="button" style="margin-top:1em;" class="btn btn-default" onclick="themeAndWidgetsForm.hide()" value="Done">Done</button>
            </p:tab>
        </p:tabView>
    </p:dialog>

  <script type="text/javascript">
        // <![CDATA[
        
   function saveThemeHandleComplete(xhr, status, args) {
            // We only want to close the CreateSet pop-up
            // if there
            // are no validation or creation errors
          //  alert("xhr="+xhr.responseText);
            if (xhr.responseText.search('class="error"') === -1 && args.validationFailed === undefined) {
                PF('themeAndWidgetsForm').hide();
               
            } else {
         //        alert(" contains class error = "+ xhr.responseText.search('class="error"')!==-1);
            }
        }    // ]]>
    </script>
   </div> 